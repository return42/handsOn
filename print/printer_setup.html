
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Netzwerk-Drucker Setup &#8212; handsOn  Dokumentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="Wartung &amp; Diagnose" href="printer_troubleshooting.html" />
    <link rel="prev" title="Druckertreiber" href="driver.html" />
  <script>DOCUMENTATION_OPTIONS.URL_ROOT = '../';</script>
   
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Stichwortverzeichnis"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="printer_troubleshooting.html" title="Wartung &amp; Diagnose"
             accesskey="N">weiter</a> |</li>
        <li class="right" >
          <a href="driver.html" title="Druckertreiber"
             accesskey="P">zurück</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">handsOn  Dokumentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Drucken mit CUPS &amp; IPP</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Netzwerk-Drucker Setup</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="netzwerk-drucker-setup">
<span id="printer-setup"></span><h1>Netzwerk-Drucker Setup<a class="headerlink" href="#netzwerk-drucker-setup" title="Link zu dieser Überschrift">¶</a></h1>
<p>In den GNOME <span class="guilabel">Einstellungen</span> unter <span class="guilabel">Geräte/Drucker</span> kann man
den Drucker einrichten.  IPP fähige Drucker werden automatisch im Netz gefunden
und i.d.R: wählt GNOME (resp CUPS) eine <strong>driverless</strong> PPA (siehe Kapitel
„<a class="reference internal" href="driver.html#driverless-printing"><span class="std std-ref">driverless printing</span></a>“).</p>
<div class="figure align-default" id="id1">
<span id="figure-gnome-setup-printer"></span><img alt="Figure (GNOME-Setup-printer.png)" src="../_images/GNOME-Setup-printer.png" />
<p class="caption"><span class="caption-text">GNOME Einstellungen <span class="guilabel">Geräte/Drucker</span></span><a class="headerlink" href="#id1" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Man kann mal einen Druck über diesen <em>automatisch</em> eingerichteten Drucker
probieren, wenn man mit dem Ergebnis zufrieden ist, dann braucht man auch nichts
weiter zu machen.  Hier im Beispiel mit einem Canon (<a class="reference external" href="https://www.canon.de/for_home/product_finder/multifunctionals/laser/i-sensys_mf623cn">MF623Cn</a>) klappt das aber
leider nicht, deutlich zu erkennen an der Meldung <span class="guilabel">Es werden keine
Aufträge angenommen</span>.  Die Ursachen dafür können mehrschichtig sein, Canon ist
das beste (negativ) Beispiel, z.T. wurde das ja auch schon erläutert (<a class="reference internal" href="ppd.html#cupstestppd"><span class="std std-ref">REF</span></a>, <a class="reference internal" href="driver.html#driverless-vs-canon"><span class="std std-ref">REF</span></a>).  Es macht also unter
Umständen unumgänglich den Drucker manuell hinzuzufügen.</p>
<div class="section" id="drucker-manuell-hinzufugen">
<h2>Drucker manuell hinzufügen<a class="headerlink" href="#drucker-manuell-hinzufugen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Über den Button <span class="guilabel">Zusätzliche Druckereinstellungen</span> gelangt man in den
unten zu sehenden Dialog, das CUPS-Setup über die GNOME GUI
(<a class="reference internal" href="driver.html#figure-cups-system-config-printer-gui"><span class="std std-ref">system-config-printer</span></a>).</p>
<div class="figure align-default" id="id2">
<span id="figure-cups-system-config-printer"></span><img alt="Figure (system-config-printer.png)" src="../_images/system-config-printer.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">system-config-printer</span></code>: CUPS Drucker-Setup auf dem <code class="docutils literal notranslate"><span class="pre">localhost</span></code></span><a class="headerlink" href="#id2" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Alternativ kann das CUPS-Setup auch im WEB Browser unter
<a class="reference external" href="http://localhost:631/printers">http://localhost:631/printers</a> über HTML Formulare vorgenommen werden.  Auch wenn
es immer eine HTML-GUI gibt (z.B. auf Servern die keinen Desktop haben), am
komfortabelsten ist es immer noch die GNOME GUI auf dem Desktop zu nutzen.</p>
<p>Wie bereits erwähnt, läuft der CUPS Dienst nicht im Kontext des Benutzers
sondern als eigenständiger Dienst auf dem Server.  Damit nicht einfach jeder
beliebige Benutzer da was <em>verstellen</em> kann, gibt es Berechtigungen.  Die GNOME
GUI’s nutzen zum Teil das PolicyKit <a class="reference external" href="https://www.freedesktop.org/wiki/Software/cups-pk-helper">cups-pk-helper</a> aus dem gleichnamigen
APT-Paket, allerdings stehen darüber auch nicht immer alle Berechtigungen zur
Verfügung.  Nur Benutzer die zur Gruppe <code class="docutils literal notranslate"><span class="pre">lpadmin</span></code> (Drucker-Admins) gehören,
können auch alle Einstellungen vornehmen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ members lpadmin
cups-pk-helper &lt;benutzername&gt; &lt;benutzername&gt; ...
</pre></div>
</div>
<p>Weshalb man sich am besten noch zu der Gruppe Drucker-Admins (<code class="docutils literal notranslate"><span class="pre">lpadmin</span></code>)
hinzufügt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo -H gpasswd -a &lt;benutzername&gt; lpadmin
</pre></div>
</div>
<p>Über <span class="menuselection">Hinzufügen ‣ Netzwerkdrucker</span> den Drucker suchen lassen
und dann als Verbindung <code class="docutils literal notranslate"><span class="pre">ipp/print</span></code> auswählen (sicherstellen, dass oben die
Geräteadresse mit <code class="docutils literal notranslate"><span class="pre">ipp://</span></code> beginnt).</p>
<div class="figure align-default" id="id3">
<img alt="../_images/system-config-printer-NEW.png" src="../_images/system-config-printer-NEW.png" />
<p class="caption"><span class="caption-text">CUPS: Drucker-Verbindung über IPP</span><a class="headerlink" href="#id3" title="Link zu diesem Bild">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Der Vollständigkeit wegen noch Verweise zu den anderen ggf. zur Verfügung
stehenden Protokolle: <a class="reference external" href="https://wiki.debian.org/PrintingGlossaryandIndex#dnssd">DNS-SD aka AirPrint aka Bonjour</a> und
<a class="reference external" href="https://www.cups.org/doc/network.html#SOCKET">AppSocket Protocol (aka JetDirect)</a></p>
</div>
<p>Nun muss man einen eindeutigen Druckernamen vergeben, diesen wird man später
nicht mehr ändern können.  Ich verwende hierfür die genaue Typ-Bezeichnung plus
die Seriennummer.  Als Beschreibung wähle ich <em>„Farb-Laser A4 einseitig“</em> und
bei Ort gebe ich das Büro an / z.B.:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Druckername (ID)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MF623C-TWF19694</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Beschrebung</p></td>
<td><p><em>Farb-Laser A4 einseitig</em></p></td>
</tr>
<tr class="row-odd"><td><p>Ort</p></td>
<td><p><em>Büro Markus</em></p></td>
</tr>
</tbody>
</table>
<p>Danach kann man auf <span class="guilabel">Vorwärts</span> drücken, dann kommt ein Dialog
<span class="guilabel">Treiber wird gesucht</span>, das kann einen Moment dauern.  Danach wird man
gefragt, ob man eine Test-Seite drucken möchte.  Das kann man ausprobieren, wenn
das Druck-Erzeugnis gut genug ist, ist man mit dem Einrichten des <em>driverless</em>
Treiber eigentlich schon fertig.  Aber bereits oben wurde erwähnt, dass wir
diese manuelle Installation vornehmen um weitere Anpassungen vorzunehmen.</p>
<p>Bei den Canon Druckern der MF620 Serie musste die PPD Datei für den <em>driverless</em>
angepasst werden.  Ein anständiges Druckbild ergab sich am Ende mit folgender
PPD Datei (s.a. Kapitel „<a class="reference internal" href="driver.html#driverless-printing"><span class="std std-ref">driverless printing</span></a>“):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CNMF620C-Series.ppd</span></code>: <a class="reference external" href="https://github.com/return42/handsOn/blob/master/docs/print/CNMF620C-Series.ppd">CNMF620C Series, driverless (PPD modified)</a></p></li>
</ul>
</div>
<div class="section" id="drucker-treiber-andern">
<h2>Drucker Treiber ändern<a class="headerlink" href="#drucker-treiber-andern" title="Link zu dieser Überschrift">¶</a></h2>
<p>In CUPS wird das Setup eines Druckers in einer <a class="reference internal" href="ppd.html#ppd-spec"><span class="std std-ref">PPD Datei</span></a>
hinterlegt, in dieser Datei steht dann auch drin, welcher Druckertreiber
verwendet wird.  Im Fall des <em>driverless</em> Treiber steht da <a class="reference external" href="https://github.com/OpenPrinting/cups-filters/blob/bcf4377b/cupsfilters/ppdgenerator.c#L1274">drvless.ppd</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">PCFileName</span><span class="p">:</span> <span class="s2">&quot;drvless.ppd&quot;</span>
</pre></div>
</div>
<p>Hat man den <strong>proprietären</strong> Treiber <a class="reference internal" href="driver.html#canon-urf"><span class="std std-ref">MF620C-Serie URF-II (MF623Cn)</span></a> im System installiert, so
kann man den jetzt auch für diesen Drucker nutzen.  Der Druckertreiber für die
MF620C Serie ist:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">PCFileName</span><span class="p">:</span> <span class="s2">&quot;CNM620CZK.PPD&quot;</span>
</pre></div>
</div>
<p>Theoretisch könnte man den Treiber einfach in die bestehende PPD-Datei zum
Drucker Setup eintragen (den CUPS Dienst neu starten) und dann würde der aktiv
sein.  Jedoch haben die proprietären Treiber meist eigene Optionen und
Einstellungen zu den CUPS-Filtern, die man auch übernehmen muss.  Man muss die
PPD Datei vom Hersteller installieren.  Um also Treiber und PPD richtig
einzurichten wählt man im Kontextmenü (rechte Maustaste) des Druckers die
<span class="menuselection">Eigenschaften</span> aus.  Unter <span class="guilabel">Marke und Model</span> ist hier
im Beispiel zu sehen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CNMF620C</span> <span class="n">Series</span><span class="p">,</span> <span class="n">driverless</span><span class="p">,</span> <span class="n">cups</span><span class="o">-</span><span class="n">filters</span> <span class="mf">1.20</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
<div class="figure align-default" id="id4">
<span id="figure-cups-system-config-printer-props"></span><img alt="Figure (system-config-printer-props.png)" src="../_images/system-config-printer-props.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">system-config-printer</span></code>: Drucker-Eigenschaften</span><a class="headerlink" href="#id4" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Über den <span class="guilabel">Ändern</span> Button erscheint dann der <span class="guilabel">Treiber ändern</span>
Dialog, da mal eben kurz warten, dann wird eine Auswahl angeboten.</p>
<div class="figure align-default" id="id5">
<span id="figure-cups-system-config-driver-model"></span><img alt="Figure (system-config-driver-model.png)" src="../_images/system-config-driver-model.png" />
<p class="caption"><span class="caption-text">Treiber ändern (1): Drucker-Hersteller aus Datenbank auswählen</span><a class="headerlink" href="#id5" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Dann den <strong>proprietären</strong> Treiber <a class="reference internal" href="driver.html#canon-urf"><span class="std std-ref">MF620C-Serie URF-II (MF623Cn)</span></a> auswählen.</p>
<div class="figure align-default" id="id6">
<span id="figure-cups-system-config-driver-type"></span><img alt="Figure (system-config-driver-type.png)" src="../_images/system-config-driver-type.png" />
<p class="caption"><span class="caption-text">Treiber ändern (2): Drucker-Modell aus Datenbank auswählen</span><a class="headerlink" href="#id6" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Da man den <strong>proprietären</strong> Treiber einrichtet, sollte man auch dessen PPD-Datei
(erst mal) unverändert übernehmen.</p>
<div class="figure align-default" id="id7">
<span id="figure-cups-system-config-ppd-settings"></span><img alt="Figure (system-config-ppd-settings.png)" src="../_images/system-config-ppd-settings.png" />
<p class="caption"><span class="caption-text">Treiber ändern (3): PPD Datei des Herstellers übernehmen</span><a class="headerlink" href="#id7" title="Link zu diesem Bild">¶</a></p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hinweis</p>
<p>Bei den Canon Installationen klappt das evtl. nicht immer mit der übernahme
der PPD-Datei des Herstellers, das ist daran zu erkennen, dass nach obigen
Vorgehen bei <span class="guilabel">Marke und Modell</span> immer noch <span class="menuselection">CNMF620C
Series, driverless, cups-filters 1.20.2</span> (also <strong>driverless</strong>) steht.</p>
</div>
<p>In solchen Fällen hat man noch die Möglichkeit, die PPD direkt zuzuweisen.  Das
geht auch schon über das <a class="reference internal" href="#figure-gnome-setup-printer"><span class="std std-ref">GNOME Einstellungen Geräte/Drucker</span></a>, dort klickt man auf
das <span class="guilabel">Zahnrad / Drucker-Details</span> und dann erscheint der Dialog
(<a class="reference internal" href="#figure-cups-system-config-install-ppd"><span class="std std-ref">Setup: Details Drucker</span></a>).  In dem Dialog kann man auch
überprüfen welcher Treiber verwendet wird.</p>
<div class="figure align-default" id="id8">
<span id="figure-cups-system-config-install-ppd"></span><img alt="Figure (system-config-install-PPD.png)" src="../_images/system-config-install-PPD.png" />
<p class="caption"><span class="caption-text">Setup: Details Drucker</span><a class="headerlink" href="#id8" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Hier im Beispiel ist der <strong>proprietäre</strong> Treiber <span class="guilabel">Canon MF620C Series
UFRII LT</span> gesetzt, jetzt muss aber noch die richtige PPD zum Treiber über den
Button <span class="guilabel">PPD-Datei installieren …</span> ausgewählt werden.  Bei der
Installation des <strong>proprietären</strong> Treiber <a class="reference internal" href="driver.html#canon-urf"><span class="std std-ref">MF620C-Serie URF-II (MF623Cn)</span></a> wurde die PPD Datei
für die <em>MF620C-Series</em> unter dem Pfad:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">cups</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">CNCUPSMF620CZK</span><span class="o">.</span><span class="n">ppd</span>
</pre></div>
</div>
<p>installiert.  In dem Ordner liegen auch noch ein Haufen anderer PPD Dateien, die
alle aus dem Canon Paket <code class="docutils literal notranslate"><span class="pre">cndrvcups-ufr2-uk_{3.70}-1_amd64.deb</span></code> stammen.
I.d.R. bieten die Hersteller (wenn überhaupt) nur ein Paket mit Treibern zu
allen ihren Modellen an.  Die Dateinamen setzen sich zusammen aus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CNCUPSMF620CZK</span><span class="o">.</span><span class="n">ppd</span>
<span class="o">-|</span>    <span class="o">-----|</span>
 <span class="o">|</span>         <span class="o">+--&gt;</span> <span class="n">MF620C</span><span class="p">:</span> <span class="n">Modell</span>
 <span class="o">+--&gt;</span> <span class="n">CN</span><span class="p">:</span> <span class="n">Canon</span>
</pre></div>
</div>
<p>Wenn man die richtige PPD Datei ausgewählt hat, dann kann man das schon in den
GNOME Einstellungen erkennen, dort steht bei <span class="guilabel">Modell</span> Canon MF620C
UFRII LT.</p>
<div class="figure align-default" id="id9">
<span id="figure-gnome-setup-urfii"></span><img alt="Figure (GNOME-Setup-URFII.png)" src="../_images/GNOME-Setup-URFII.png" />
<p class="caption"><span class="caption-text">GNOME Einstellungen: Modell Canon MF620C UFRII LT</span><a class="headerlink" href="#id9" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Damit ist das Setup dann abgeschlossen und es kann gedruckt werden.  Wie schon
beim <em>driverless</em> Treiber, so empfiehlt es sich auch bei <em>proprietären</em> Treibern
die PPD mal anzuschauen.  Hier meine angepasste Version für die Canon MF620C
Serie:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MF623C-TWF19694.ppd</span></code>: <a class="reference external" href="https://github.com/return42/handsOn/blob/master/docs/print/MF623C-TWF19694.ppd">Canon MF620C Series UFRII LT</a></p></li>
</ul>
<p>Falls sich noch Fragen ergeben kann man auch nochmal den Artikel im Debian Wiki
lesen: <a class="reference external" href="https://wiki.debian.org/PrinterDriver/Canon/UFR-II">Canon UFR-II</a>.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/darmarIT_logo_128.png" alt="Logo"/>
            </a></p>
  

  <h3>Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Netzwerk-Drucker Setup</a><ul>
<li><a class="reference internal" href="#drucker-manuell-hinzufugen">Drucker manuell hinzufügen</a></li>
<li><a class="reference internal" href="#drucker-treiber-andern">Drucker Treiber ändern</a></li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<ul>
  <li><a href="../index.html">Overview</a>
    <ul>
      <li><a href="index.html">Drucken mit CUPS &amp; IPP</a>
        <ul>
          <li>Previous: <a href="driver.html" title="vorheriges Kapitel">Druckertreiber</a>
          <li>Next: <a href="printer_troubleshooting.html" title="nächstes Kapitel">Wartung &amp; Diagnose</a></ul>
      </li>
    </ul>
  </li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Schnellsuche</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Los" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019 Markus Heiser.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.1.
    </div>
  <script src="../_static/version_warning_offset.js"></script>

  </body>
</html>